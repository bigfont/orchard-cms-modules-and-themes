@using System.Dynamic;
@using System.Linq;
@using Orchard.ContentManagement;
@using Orchard.Utility.Extensions;
@using LccNetwork.Bootstrap.Extensions;

@helper CreateImgFromMediaPart(dynamic mediaPart)
{
    // todo Share this with other razor views.
    var imgSrc = mediaPart != null ? mediaPart.MediaUrl : string.Empty;
    var imgAlt = mediaPart != null ? mediaPart.AlternateText : string.Empty;
    <img src="@Display.ResizeMediaUrl(Width: 116, Height: 65, Mode: "crop", Alignment: "middlecenter", Path: imgSrc)">
}
@{
    var items = (Model.ContentItems as IEnumerable<ContentItem>);
    var cssClass = items.First().TypeDefinition.Name.HtmlClassify();
    <div class="@cssClass">
        <div class="row">
            @foreach (ContentItem item in items)
            {
                var itemDisplayUrl = Url.ItemDisplayUrl(item);
                // get the mainPart, so we can access the item's fields
                dynamic mainPart = MyFunctions.GetMainPartFromContentItem(item);
                var mediaPart = MyFunctions.GetMediaPartFromMediaLibraryPickerField(mainPart.Image, 0);
                var shortTitle = mainPart.ShortTitle.Value;
                var summary = mainPart.Summary.Value;
                // keep in mind that our theme has a grid with 36 columns
                <div class="col-md-6">
                    @CreateImgFromMediaPart(mediaPart)
                    <h6>@shortTitle</h6>
                    <p>@summary</p>
                    <a href="@itemDisplayUrl">View</a>
                </div>
            }
        </div>
    </div>
}